from pwn import xor

with open("./ch3.bmp", "rb") as f:
    ct = f.read()

# https://asecuritysite.com/magic/bmp?file=activated.bmp
header_samples = [
    "424D3E070000000000003600000028000000",
    "424D3E070000000000003600000028000000",
    "424D32300000000000003600000028000000",
    "424D26022100000000003604000028000000",
    "424D66B40000000000003600000028000000"
]

for bmp_head in header_samples:
    bmp_head= bytes.fromhex(bmp_head)
    print(xor(bmp_head, ct[:len(bmp_head)]))

key = b"fallen"

with open("./flag.bmp", "wb") as f:
    f.write(xor(key, ct))