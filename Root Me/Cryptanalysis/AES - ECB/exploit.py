from Crypto.Cipher import AES
from pwn import *

with open("./mylogin.cnf", "rb") as f:
    enc = f.read()

ct = enc[4+20:]
_k = enc[4:4+20]
key = [0]*16

for i in range(len(_k)):
    key[i%16] ^= _k[i]

key = bytes(key)
cipher = AES.new(key, AES.MODE_ECB)

fp = 0
message = b""
while fp < len(ct):
    _len = u32(ct[fp:fp+4])
    block = ct[fp+4:fp+4+_len]
    message  += cipher.decrypt(block)
    fp += 4 + _len

print(message.decode())