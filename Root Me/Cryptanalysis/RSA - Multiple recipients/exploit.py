from sage.all import *
from Crypto.Util.number import *
from Crypto.PublicKey import RSA
from base64 import b64decode

N = []
E = []
C = []

def load_data(path_key, path_ct):
    global N, E, C

    with open(path_key, "r") as f:
        key = RSA.importKey(f.read())
        N += [key.n]; E += [key.e]
    with open(path_ct, "r") as f:
        C += [bytes_to_long(b64decode(f.read().strip()))]

if __name__ == '__main__':
    load_data("./clef0_pub.pem", "./m0")
    load_data("./clef1_pub.pem", "./m1")
    load_data("./clef2_pub.pem", "./m2")

    c = crt(C, N)
    m = ZZ(c).nth_root(3)
    print(long_to_bytes(m))