from Crypto.Util.number import *
from Crypto.PublicKey import RSA
from base64 import b64decode
from factordb.factordb import FactorDB

with open("./pubkey.pem", "r") as f:
    key = RSA.importKey(f.read())

N, e = key.n, key.e
ct = bytes_to_long(b64decode("e8oQDihsmkvjT3sZe+EE8lwNvBEsFegYF6+OOFOiR6gMtMZxxba/bIgLUD8pV3yEf0gOOfHuB5bC3vQmo7bE4PcIKfpFGZBA"))

f = FactorDB(N); f.connect()
p, q = f.get_factor_list()
d = inverse(e, (p - 1)*(q - 1))

m = pow(ct, d, N)
print(long_to_bytes(m))